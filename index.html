<script>
console.log('consent v007');

let marketingConsentIsGiven = false;

if (JSON.parse(getCookie('SEBConsents'))?.consents?.marketing) {
  marketingConsentIsGiven = JSON.parse(getCookie('SEBConsents')).consents.marketing === true;
}

const headerTag = document.querySelector('head');
const gtagScript = document.createElement('script');
gtagScript.src = 'https://www.googletagmanager.com/gtag/js?id=G-0VVS6NME1D&l=myTrackingData';
headerTag.appendChild(gtagScript);



window.myTrackingData = window.myTrackingData || [];
function gtag() { 
  console.log(999, arguments);
  myTrackingData.push(arguments); 
}
gtag('js', new Date());
gtag('config', 'G-0VVS6NME1D');

// Set the default consent state
(function () {
  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'analytics_storage': 'denied',
    'wait_for_update': 500
  });
})()

function grantMarketingConsent() {
  gtag('consent', 'update', {
    'ad_user_data': 'granted',
    'ad_personalization': 'granted',
    'ad_storage': 'granted',
    'analytics_storage': 'granted'
  });
}

function denyMarketingConsent() {
  gtag('consent', 'update', {
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'ad_storage': 'denied',
    'analytics_storage': 'denied'
  });
}

function getCookie(name) {
    const cookies = document.cookie.split(';');

    for (let i = 0; i < cookies.length; i++) {
        let cookie = cookies[i].trim();

        if (cookie.startsWith(encodeURIComponent(name) + '=')) {
            const value = cookie.substring(encodeURIComponent(name).length + 1);
            
            return decodeURIComponent(value);
        }
    }

    return null;
}

function trackAndNavigate(url, buttonName) {
    gtag('event', 'outbound_button_click', {
        link_url: url,
        link_text: buttonName,
        link_target: '_blank'
    });
    window.open(url, '_blank');
}
</script>

<button onclick="showCookiePopup()" id="102670_auswia">cookie settings</button></br></br>
<button onclick="grantMarketingConsent()">Grant tracking</button></br></br>
<button onclick="denyMarketingConsent()">Deny tracking</button></br></br>

<button onclick="trackAndNavigate('https://www.google.lt', 'Google Link One')">One</button></br></br>
<button onclick="trackAndNavigate('https://www.google.lt', 'Google Link Two')">Two</button></br></br>
<button onclick="trackAndNavigate('https://www.google.lt', 'Google Link Three')">Three</button>
